# OSI模型

最近网络的巨大变革[SDN](D1net.com)


## 1. 物理层
- 传输单元：比特

- 传输介质：双绞线、同轴电缆、光纤、无线信号
- 信道复用技术：频分复用FDM、时分复用TDM、统计时分复用STDM、波分复用WDM、码分复用CDM

## 2.链路层（data-link layer）
- 传输单元：帧
- 封装成帧、透明传输、差错检测

- 点对点协议PPP：
1. 简单：不需要纠错、不需要序号、不需要流量控制
2. 封装成帧
3. 透明性
4. 多种网络层协议
5. 多种类型链路： PPPoE 以太网~ppp
6. 差错检测
7. 检测连接状态
8. 最大传送单元 MTU： 帧可以载荷的数据部分的最大长度
9. 网络层地址协商
10. 数据压缩协商

- 以太网：
    - 无连接、曼彻斯特编码
    - CSMA/CD协议：多点接入、载波监听、碰撞检测
    - 争用期：51.2μs
    - 帧间最小间隔：9.6μs

- **MAC地址**：
    MAC帧： 不少于64字节

6 | 6 | 2 |  46~1500 |  4
---|---|---|---|---
目的地址|源地址|类型|ip数据报|FCS 

ps：FCS 帧检验序列（CRC校验）

## 3.网络层（network layer）
- IP地址：
    - A类地址：0
    - B类地址：10
    - C类地址：110
    - D类地址：1110（多播）
    - E类地址：1111



- arp协议：把IP地址解析出在数据链路层使用的MAC地址

- ip数据报：45~1500字节
  |MAC地址|IP地址|TCP报文|
    - 首部的相关字段：版本4、首部长度4、区分服务8、总长度16、标识16、标志3、片偏移13、生存时间TTL 8、协议8、首部校验和16、源地址32、目的地址32

- 子网划分：子网掩码

- 网际控制报文协议ICMP：——PING
    - ICMP差错报告报文：终点不可达、源点抑制、时间超过、参数问题、改变路由（重定向）
    - ICMP询问报文：回送请求和回答、时间戳请求和回答

- 路由选择协议：
    - 内部网关协议IGP：路由信息协议RIP（15跳）、开放最短路径优先 OSPF
    - 外部网管协议EGP：边界网关协议BGP

- 路由器：路由选择、分组转发

- 虚拟专用网VPN
- 网络地址转换NAT

## 4.运输层
### **TCP/UDP**
- TCP：三次握手、四次挥手
    - 面向连接
    - 一对一
    - 可靠交付
    - 全双工通信
    - 面向字节流
    - 以字节为单位的滑动窗口：慢开始、拥塞避免、快重传、快恢复

TCP首部：
| 源端口  | 目的端口 | 序号   | 确认号  | 数据偏移 | 保留   | 紧急URG | 确认ACK | 推送PSH | 复位RST | 同步SYN | 终止FIN | 窗口   | 检验和  | 紧急指针 | 选项   |
| ---- | ---- | ---- | ---- | ---- | ---- | ----- | ----- | ----- | ----- | ----- | ----- | ---- | ---- | ---- | ---- |
| 2    | 2    | 4    | 4    | 4    | 6    | 1     | 1     | 1     | 1     | 1     | 1     | 2    | 2    | 2    | 最长40 |

- UDP：
    - 无连接
    - 尽最大努力交付
    - 面向报文
    - 没有拥塞控制
    - 支持一对一、一对多、多对一、多对多的交互通信
    - 首部开销小

伪首部：仅为了计算检验和，不传递
| 源IP地址 | 目的IP地址 | 0    | 17   | UDP长度 |
| ----- | ------ | ---- | ---- | ----- |
| 4     | 4      | 1    | 1    | 2     |
UDP首部：
| 伪首部  | 源端口  | 目的端口 | 长度   | 检验和  |
| ---- | ---- | ---- | ---- | ---- |
| 12   | 2    | 2    | 2    | 2    |

## 5. 应用层
- 域名系统DNS：递归查询、迭代查询

- 文件传输协议FTP：端口21

- 远程终端协议TELNET

- HTTP：
    - 面向事务
    - 本身无连接
    - 无状态
    - 持续连接1.1

    请求报文的一些方法：

    | 方法（操作）  |        意义         |
    | :-----: | :---------------: |
    | OPTION  |     请求一些选项的信息     |
    |   GET   |  请求读取由URL所标志的信息   |
    |  HEAD   | 请求读取由URL所标志的信息的首部 |
    |  POST   |  给服务器添加信息（例如，注释）  |
    |   PUT   |  在指明的URL下存储一个文档   |
    | DELETE  |  删除指明的URL所标志的资源   |
    |  TRACE  |   用来进行环回测试的请求报文   |
    | CONNECT |      用于代理服务器      |


请求报文：

GET /chn/zxczxc/index.htm HTTP/1.1

HOST:www.tsinghua.edu.cn

Connection:close

User-Agent:Mozilla/5.0

Accept-Language:cn

 响应报文状态码：

1xx表示通知信息的，如 收到请求或正在处理

2xx表示成功，如结合艘或知道了

3xx表示重定向，如要完成请求还要采取进一步的行动

4xx表示客户的差错，如请求中有错误的语法或不能完成

5xx表示服务器的差错，如服务器失效无法完成请求

ps：202-接受、400-错误请求、404-not found、301-永久转移