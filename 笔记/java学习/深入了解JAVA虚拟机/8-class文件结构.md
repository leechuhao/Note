class文件是一组以8位字节为基础单位的二进制流。Class文件格式采用一种类似于C语言结构体的伪结构来存储数据，这种结构中只有两种数据类型：无符号数和表。

无符号数：以u1、u2、u4、u8分别代表1个字节、2个字节、4个字节、8个字节。可以用来描述数字、索引引用、数量值或者按照UTF-8编码构成字符串值。

表：有多个无符号数或者其他表作为哦数据项构成的符合数据类型，所有表都习惯性地以“_info”结尾。

![](C:\Users\brain\Desktop\笔记\java学习\深入了解JAVA虚拟机\微信截图_20180411214801.png)

### 魔数

4个字节，唯一作用是确定这个文件是否为一个能被虚拟机接受的Class文件。0xCAFEBABE

### class版本

2个字节次版本号，2个字节主版本号

### 常量池

可以理解为class文件中的资源仓库，它是class文件结构中与其他项目关联最多的数据类型，也是占用class文件空间最大的数据项目之一。

在常量池放置u2类型那个的数据，代表常量池容量计数值。（容量计数从1开始）

主要放置两种常量：

1. 字面量

接近于Java的常量概念

2. 符号引用

- 类和接口的全限定名
- 字段的名称和描述符
- 方法的名称和描述符

每一个常量就是一个表，现有14种表，这些表各自都有自己都有结构，但是有一个共同的特点：表的第一位是一个u1类型的标志位![微信截图_20180411224058](C:\Users\brain\Desktop\笔记\java学习\深入了解JAVA虚拟机\微信截图_20180411224058.png)

### 访问标志

2个字节，用于标识一些类或接口层次的访问信息，如这个class是类还是接口；是否定义为public类型；是否定义为abstract类型；如果是类的话，是否被声明为final等。

![微信截图_20180411224842](C:\Users\brain\Desktop\笔记\java学习\深入了解JAVA虚拟机\微信截图_20180411224842.png)

### 类索引

一个u2类型的索引值，指向一个类型为CONSTANT_Class_info的类描述符常量，通过该值可以找到在CONSTANT_Utf8_info类型的常量中全限定名字符串。

### 父类索引

一个u2类型的索引值，指向一个类型为CONSTANT_Class_info的类描述符常量，通过该值可以找到在CONSTANT_Utf8_info类型的常量中全限定名字符串。

### 接口索引集合

首先是一个u2类型的数据作为接口计数器，表示索引表的容量。

### 字段表集合

首先有一个u2类型的数据为容量计数器field_count

用于描述接口或者类中声明的变量。可以包括的信息有：字段的作用域（public、private、protected）、是实例变量还是类变量（static）、可变性（final）、并发可见性（volatile，是否强制从主内存读写）、可否序列化（transient）、字段数据类型（基本类型、对象、数组）、字段名称。

![微信截图_20180411230307](C:\Users\brain\Desktop\笔记\java学习\深入了解JAVA虚拟机\微信截图_20180411230307.png)

### 方法表集合

和字段表几乎完全一致，依次为：访问标志（access_flags）、名称索引（name_index）、描述符索引（descriptor_index）、属性表集合（attributes）

![微信截图_20180411234133](C:\Users\brain\Desktop\笔记\java学习\深入了解JAVA虚拟机\微信截图_20180411234133.png)

![微信截图_20180411234206](C:\Users\brain\Desktop\笔记\java学习\深入了解JAVA虚拟机\微信截图_20180411234206.png)

### 属性表集合

这是在方法表集合里其中一项，现有21项属性，每项属性都有独立的结构

![QQ拼音截图20180412140423](C:\Users\brain\Desktop\笔记\java学习\深入了解JAVA虚拟机\QQ拼音截图20180412140423.png)

![微信截图_20180412140652](C:\Users\brain\Desktop\笔记\java学习\深入了解JAVA虚拟机\微信截图_20180412140652.png)

![微信截图_20180412140750](C:\Users\brain\Desktop\笔记\java学习\深入了解JAVA虚拟机\微信截图_20180412140750.png)

